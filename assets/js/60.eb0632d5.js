(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{780:function(s,a,t){"use strict";t.r(a);var n=t(6),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("a",{attrs:{href:"https://buildroot.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("buildroot"),t("OutboundLink")],1),s._v(" 是一个简单、高效、易用的工具，能够利用交叉编译生成嵌入式 Linux 系统。")]),s._v(" "),t("p",[s._v("本文简单介绍 buildroot 的构建流程，以便于快速入门，了解其基本使用方式。")]),s._v(" "),t("blockquote",[t("p",[s._v("为了便于复现，操作环境使用了 "),t("a",{attrs:{href:"https://hub.docker.com/layers/ubuntu/library/ubuntu/20.04/images/sha256-c7b16f05260ce7a6a124cbd68cb061795840870e313de902fb6c987d0c7488c5?context=explore",target:"_blank",rel:"noopener noreferrer"}},[s._v("ubuntu 20.04"),t("OutboundLink")],1),s._v(" 的 docker 镜像，具体的 buildroot 版本为 "),t("a",{attrs:{href:"https://github.com/buildroot/buildroot/tree/2021.02",target:"_blank",rel:"noopener noreferrer"}},[s._v("2021.02"),t("OutboundLink")],1),s._v("。")])]),s._v(" "),t("p",[s._v("buildroot 从零开始构建的过程还是很复杂的。有机会的话，往后再写文章一步步介绍。我们先来看看如何在现有项目加入新应用的构建方法。详尽的教程可参见 "),t("a",{attrs:{href:"https://buildroot.org/downloads/manual/manual.html#adding-packages",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("h2",{attrs:{id:"将自己的应用加入-buildroot-打包的系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#将自己的应用加入-buildroot-打包的系统"}},[s._v("#")]),s._v(" 将自己的应用加入 buildroot 打包的系统")]),s._v(" "),t("p",[s._v("本节以加入自己的 hello 应用为例，在 aarch64_efi_defconfig 的项目下，加入 hello 包，将 hello 的应用源代码编译生成到 rootfs 根文件系统。")]),s._v(" "),t("blockquote",[t("p",[s._v("aarch64 和 arm64 的关系参见 "),t("a",{attrs:{href:"https://stackoverflow.com/questions/31851611/differences-between-arm64-and-aarch64/47274698#47274698",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),t("OutboundLink")],1),s._v("。结论为两者是同一个东西。")])]),s._v(" "),t("h3",{attrs:{id:"_1-启动容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-启动容器"}},[s._v("#")]),s._v(" 1. 启动容器")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker run -it --rm -w /buildroot ubuntu:20.04 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("后续操作都在这个启动的容器内进行。")])]),s._v(" "),t("h3",{attrs:{id:"_2-替换软件源-可选"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-替换软件源-可选"}},[s._v("#")]),s._v(" 2. 替换软件源（可选）")]),s._v(" "),t("p",[s._v("此步骤主要用于加速软件安装，主要参考中科大的 "),t("a",{attrs:{href:"http://mirrors.ustc.edu.cn/help/ubuntu.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Ubuntu 源使用帮助"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/archive.ubuntu.com/mirrors.ustc.edu.cn/g'")]),s._v(" /etc/apt/sources.list\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed -i 's/archive.ubuntu.com/mirrors.tuna.tsinghua.edu.cn/g' /etc/apt/sources.list")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/security.ubuntu.com/mirrors.ustc.edu.cn/g'")]),s._v(" /etc/apt/sources.list\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed -i 's/security.ubuntu.com/mirrors.tuna.tsinghua.edu.cn/g' /etc/apt/sources.list")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"_3-安装依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装依赖"}},[s._v("#")]),s._v(" 3. 安装依赖")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" libncurses5-dev g++ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" cpio "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bc")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" tree "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_4-创建-hello-项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-创建-hello-项目"}},[s._v("#")]),s._v(" 4. 创建 hello 项目")]),s._v(" "),t("h4",{attrs:{id:"项目结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目结构"}},[s._v("#")]),s._v(" 项目结构")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tree ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-- hello-0.1\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-- Makefile\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("-- main.c\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("-- package\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-- Config.in\n    `-- hello.mk\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" directories, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" files\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("blockquote",[t("p",[s._v("注意："),t("strong",[s._v("文件名很关键")]),s._v("。hello.mk 要小写，而且不能乱取其它名字，因为 buildroot 框架有一套根据命名用于展开 hello 包的规则，所以用 buildroot 构建项目一定要遵守本文的命名规则，否则会有各种报错。")])]),s._v(" "),t("p",[s._v("各个文件具体内容如下。")]),s._v(" "),t("h4",{attrs:{id:"hello-0-1-main-c"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hello-0-1-main-c"}},[s._v("#")]),s._v(" hello-0.1/main.c")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello world!\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h4",{attrs:{id:"hello-0-1-makefile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hello-0-1-makefile"}},[s._v("#")]),s._v(" hello-0.1/Makefile")]),s._v(" "),t("div",{staticClass:"language-makefile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-makefile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 应和 hello.mk 传入的 $(OUT_BIN) 保持一致")]),s._v("\napp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("OUT_BIN"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("app"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token symbol"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),s._v("(app)")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" main.c\n\t"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CC"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -o "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$@")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$<")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v("clean")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("@")]),s._v("rm -rf "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("app"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h4",{attrs:{id:"package-config-in"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#package-config-in"}},[s._v("#")]),s._v(" package/Config.in")]),s._v(" "),t("p",[s._v("这个文件类似 Kconfig 的配置文件，命名格式遵循和 Linux Kernel 的 Kconfig 文件规范。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('config BR2_PACKAGE_HELLO\nbool"hello world"  \nhelp  \n  hello world to you\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("这段配置的命名规则也同样重要")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("BR2_PACKAGE_HELLO")]),s._v(" 是 hello 可被 buildroot 识别编译成 package 的配置变量。Package 应用一定要以 "),t("code",[s._v("BR2_PACKAGE_")]),s._v(" 作为开头，以 "),t("code",[s._v("HELLO")]),s._v(" 即 hello 的大写来填充这个变量名，这样才能被 buildroot 命名框架识别和展开，才能通过 "),t("code",[s._v("make nconfig")]),s._v(" 来配置。")]),s._v(" "),t("li",[t("code",[s._v("bool")]),s._v(" 是变量的类型，有 "),t("code",[s._v("true")]),s._v("（编译选中）/"),t("code",[s._v("false")]),s._v("（编译未选中）两种值，和 Kconfig 的规则一样，后面的字符串和 "),t("code",[s._v("help")]),s._v(" 都是在 "),t("code",[s._v("make nconfig")]),s._v(" 时的提示文本。")])]),s._v(" "),t("p",[s._v("实际上，Config.in 可以参考 Linux Kernel 的 Kconfig 文件，根据语法规范，加入自己的配置逻辑和其它可配置的变量（比如 hello 的下载地址链接），在此不再赘述。大家可以参考 /buildroot/package 目录下其它包 Config.in 文件的写法。这里只说重点："),t("strong",[t("code",[s._v("BR2_PACKAGE_HELLO")]),s._v(" 这个变量一定要有，一定要被选上才能编译")]),s._v("。")]),s._v(" "),t("h4",{attrs:{id:"package-hello-mk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#package-hello-mk"}},[s._v("#")]),s._v(" package/hello.mk")]),s._v(" "),t("p",[s._v("按照 Makefile 文件的格式和语法规范，编写 hello 的上层构建规则如下")]),s._v(" "),t("div",{staticClass:"language-makefile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-makefile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("################################################################################  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hello")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("################################################################################  ")]),s._v("\nHELLO_VERSION "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0.1\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# file/local 后面绝对不能有空格!!!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#HELLO_SITE_METHOD = file")]),s._v("\nHELLO_SITE_METHOD "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" local\nHELLO_SITE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /buildroot/hello-"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HELLO_VERSION"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nHELLO_ALWAYS_BUILD "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" YES  \nHELLO_INSTALL_STAGING "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" YES  \nHELLO_CFLAGS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("   \nHELLO_LDFLAGS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("   \nOUT_BIN "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hello  \nHELLO_MAKE_FLAGS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" \\\n    CROSS_COMPILE"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$(CCACHE) $(TARGET_CROSS)"')]),s._v("   \\\n    CC"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TARGET_CC"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                             \\\n    OUT_BIN"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("OUT_BIN"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                          \\\n    AR"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TARGET_AR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                             \\\n    STRIP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TARGET_STRIP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                       \\\n    CFLAGS"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HELLO_CFLAGS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                      \\\n    LDFLAGS"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HELLO_LDFLAGS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                    \\\n    TARGET_DIR"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TARGET_DIR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                    \\\n    STAGING_DIR"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STAGING_DIR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#HELLO_MAKE_FLAGS += ")]),s._v("\n  \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("define")]),s._v(" HELLO_BUILD_CMDS  \n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MAKE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" clean  -C "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(@D)")]),s._v("   \n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MAKE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HELLO_MAKE_FLAGS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  -C "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(@D)")]),s._v("  \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("endef")]),s._v("  \n  \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("define")]),s._v(" HELLO_INSTALL_TARGET_CMDS  \n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("INSTALL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -m 0755 -D "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(@D)")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("OUT_BIN"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TARGET_DIR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("/usr/bin  \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("endef")]),s._v("  \n  \n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("eval")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("generic-package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br")])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"},[s._v("注意事项")]),t("p",[s._v("hello.mk 并不能实际代替 hello 源码的 Makefile 文件。它只是一个上层的 make 文件，告诉 buildroot")]),s._v(" "),t("ul",[t("li",[s._v("到哪个地方拿源代码")]),s._v(" "),t("li",[s._v("如何解压源代码")]),s._v(" "),t("li",[s._v("给源码的 Makefile 变量传递哪些编译参数")]),s._v(" "),t("li",[s._v("编译出来的库和可执行文件，应该安装到 rootfs 的哪个路径")])]),s._v(" "),t("p",[s._v("具体 hello 源码是如何一步一步编译的，还得靠其源码本身的 Makefile 去做。")])]),t("p",[s._v("这段 Makefile 代码的大致规范如下：")]),s._v(" "),t("ol",[t("li",[s._v("所有的变量都已 "),t("code",[s._v("HELLO_")]),s._v(" 开头，这样 buildroot 才能够通过命名框架去解析")]),s._v(" "),t("li",[s._v("关于变量\n"),t("ul",[t("li",[t("code",[s._v("_VERSION")]),s._v(" 结尾的变量，是下载 hello 源码的版本号")]),s._v(" "),t("li",[t("code",[s._v("_SITE_METHOD")]),s._v(" 结尾的变量说明 hello 包的下载方法")]),s._v(" "),t("li",[t("code",[s._v("_SITE")]),s._v(" 结尾的变量是 hello 包的下载地址")]),s._v(" "),t("li",[s._v("其它的变量的用途，请移步 "),t("a",{attrs:{href:"https://buildroot.org/downloads/manual/manual.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方手册"),t("OutboundLink")],1),s._v("。")])])]),s._v(" "),t("li",[s._v("所有以 "),t("code",[s._v("define")]),s._v(" 开头并以 "),t("code",[s._v("_CMDS")]),s._v(" 结尾的代码块，类似函数的东西，实际上是构建过程会被 buildroot 框架执行的指令。这些指令到底有哪些，具体也得读 "),t("a",{attrs:{href:"https://buildroot.org/downloads/manual/manual.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("手册"),t("OutboundLink")],1),s._v("。当然这些类似函数，开头也得是 "),t("code",[s._v("HELLO_")]),s._v("。buildroot 的命名规则很重要，重要的话说三遍。")]),s._v(" "),t("li",[t("code",[s._v("_BUILD_CMDS")]),s._v(" 结尾的函数是构建过程函数，负责给 hello 源代码传递编译和链接选项，调用源代码的 Makefile 执行编译。")]),s._v(" "),t("li",[t("code",[s._v("INSTALL_TARGET_CMDS")]),s._v(" 结尾的函数，负责 hello 编译完之后执行自动安装。一般是让 buildroot 把编译出来库和可执行文件安装到指定的目录。")]),s._v(" "),t("li",[t("strong",[t("code",[s._v("$(eval $(generic-package))")]),s._v(" 是最核心的东西，一定不能够漏了，不然 hello 编译不出来")]),s._v("。这个函数就是把整个 hello.mk 构建脚本，通过 buildroot 框架的方式，展开到 buildroot/ 目录下的 Makfile，生成 hello 的构建目标（构建目标是什么，还记得 Makefile 的语法吗？）。")]),s._v(" "),t("li",[s._v("实际上这些构建命名框架还有 "),t("code",[s._v("$(eval $(generic-package))")]),s._v(" 这个黑魔法，源自 package/pkg-generic.mk 这个文件。"),t("code",[s._v("generic-package")]),s._v(" 是这个文件最后调用的函数生成的。其它 "),t("code",[s._v("*_BUILD_CMDS")]),s._v("，"),t("code",[s._v("*_INSTALL_TARGET_CMDS")]),s._v(" 这些函数如何被 buildroot 框架嵌入的，之前那些变量是如何被调用的，在 package/pkg-generic.mk 都能找到，但还是要一定的 Makefile 功底才能读懂这个的，以后有机会再解释 package/pkg-generic.mk 的框架原理。")])]),s._v(" "),t("p",[s._v("讲了这么多条规范，那么这份 Makefile 大概是什么意思呢？这段代码其实描述了这么个流程")]),s._v(" "),t("ol",[t("li",[t("code",[s._v("local")]),s._v(" 指示从本地的 "),t("code",[s._v("/buildroot/hello-$(HELLO_VERSION)")]),s._v(" 目录拷贝 hello 应用的源码\n"),t("ul",[t("li",[s._v("buildroot 还支持 "),t("code",[s._v("file")]),s._v("/"),t("code",[s._v("git")]),s._v(" 等源码拉取方式，详情参见 "),t("a",{attrs:{href:"https://buildroot.org/downloads/manual/manual.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("li",[s._v("请务必保证路径不要写错= =")])])]),s._v(" "),t("li",[t("code",[s._v("HELLO_BUILD_CMDS")]),s._v(" 函数传递编译参数，并且编译 hello")]),s._v(" "),t("li",[t("code",[s._v("HELLO_INSTALL_TARGET_CMDS")]),s._v(" 把编译出来的可执行文件安装到 "),t("code",[s._v("$(TARGET_DIR)/usr/bin")]),s._v(" 目录")])]),s._v(" "),t("h3",{attrs:{id:"_5-拉取-buildroot-代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-拉取-buildroot-代码"}},[s._v("#")]),s._v(" 5. 拉取 buildroot 代码")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf buildroot")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 直接从代理节点克隆 buildroot 代码库")]),s._v("\nroot@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git clone -b 2021.02 https://hub.fastgit.org/buildroot/buildroot.git")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 移除提交历史，压缩项目大小")]),s._v("\nroot@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf buildroot/.git")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"_6-创建工作空间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-创建工作空间"}},[s._v("#")]),s._v(" 6. 创建工作空间")]),s._v(" "),t("blockquote",[t("p",[s._v("这一步主要是为了防止操作工作出错导致 buildroot 源码被污染后，需要重新拉取 buildroot 源码的问题。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# outDir=_packed")]),s._v("\nroot@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf $outDir")]),s._v("\nroot@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir $outDir")]),s._v("\nroot@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# br=$outDir/buildroot")]),s._v("\nroot@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf $br")]),s._v("\nroot@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp -r buildroot $br")]),s._v("\nroot@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp -r package $br/package/hello")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 往 _packed/buildroot/package/Config.in 加入 source "package/hello/Config.in" ')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以便将 hello 的配置文件纳入 buildroot 的包管理系统")]),s._v("\nroot@0c6ea3e52ccf:/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed -i '11s!^!        source \"package/hello/Config.in\"!g' $br/package/Config.in")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"_7-配置编译选项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-配置编译选项"}},[s._v("#")]),s._v(" 7. 配置编译选项")]),s._v(" "),t("h4",{attrs:{id:"_1-查询可用的目标系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-查询可用的目标系统"}},[s._v("#")]),s._v(" 1. 查询可用的目标系统")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@0c6ea3e52ccf:~/optee/buildroot/_packed/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make list-defconfigs")]),s._v("\nBuilt-in configs:\n  aarch64_efi_defconfig               - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" aarch64_efi\n  acmesystems_aria_g25_128mb_defconfig - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" acmesystems_aria_g25_128mb\n  acmesystems_aria_g25_256mb_defconfig - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" acmesystems_aria_g25_256mb\n  acmesystems_arietta_g25_128mb_defconfig - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" acmesystems_arietta_g25_128mb\n  acmesystems_arietta_g25_256mb_defconfig - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" acmesystems_arietta_g25_256mb\n  amarula_a64_relic_defconfig         - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" amarula_a64_relic\n  amarula_vyasa_rk3288_defconfig      - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" amarula_vyasa_rk3288\n  andes_ae3xx_defconfig               - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" andes_ae3xx\n  arcturus_ucls1012a_defconfig        - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" arcturus_ucls1012a\n  arcturus_ucp1020_defconfig          - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" arcturus_ucp1020\n  arm_foundationv8_defconfig          - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" arm_foundationv8\n  arm_juno_defconfig                  - Build "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" arm_juno\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("blockquote",[t("p",[s._v("本文以 "),t("code",[s._v("aarch64_efi_defconfig")]),s._v(" 为例。")])]),s._v(" "),t("h4",{attrs:{id:"_2-选定目标系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-选定目标系统"}},[s._v("#")]),s._v(" 2. 选定目标系统")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@0c6ea3e52ccf:/buildroot/_packed/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make aarch64_efi_defconfig")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# configuration written to /buildroot/_packed/buildroot/.config")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"_3-打开配置菜单"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-打开配置菜单"}},[s._v("#")]),s._v(" 3. 打开配置菜单")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 采用终端式菜单")]),s._v("\nroot@0c6ea3e52ccf:/buildroot/_packed/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make nconfig")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("弹出对话窗口如下")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("\n                /buildroot/_packed/buildroot/.config - Buildroot "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021.02")]),s._v(" Configuration\n┌── Buildroot "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021.02")]),s._v(" Configuration ─────────────────────────────────────────────────────────────────┐\n│                                                                                                    │\n│                                     Target options  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                           │\n│                                     Build options  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                            │\n│                                     Toolchain  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                │\n│                                     System configuration  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                     │\n│                                     Kernel  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                   │\n│                                     Target packages  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                          │\n│                                     Filesystem images  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                        │\n│                                     Bootloaders  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                              │\n│                                     Host utilities  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                           │\n│                                     Legacy config options  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                    │\n│                                                                                                    │\n│                                                                                                    │\n└F1Help─F2SymInfo─F3Help "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("─F4ShowAll─F5Back─F6Save─F7Load─F8SymSearch─F9Exit─────────────────────────┘\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h4",{attrs:{id:"_4-按下箭头选择-target-packages-进入如下界面"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-按下箭头选择-target-packages-进入如下界面"}},[s._v("#")]),s._v(" 4. 按下箭头选择 "),t("code",[s._v("Target packages")]),s._v("，进入如下界面")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("\n                 /buildroot/_packed/buildroot/.config - Buildroot "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021.02")]),s._v(" Configuration\n ┌── Target packages ─────────────────────────────────────────────────────────────────────────────────┐\n │                                                                                                    │\n │          -*- BusyBox                                                                               │\n │              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("package/busybox/busybox.config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" BusyBox configuration "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" to use? "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEW"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             │\n │              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    Additional BusyBox configuration fragment files "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEW"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                           │\n │          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   Show packages that are also provided by busybox "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEW"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                               │\n │          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   Individual binaries "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEW"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                           │\n │          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   Install the watchdog daemon startup script "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEW"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                    │\n │          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" hello world "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEW"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                     │\n │              Audio and video applications  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                    │\n │              Compressors and decompressors  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                   │\n │              Debugging, profiling and benchmark  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                              │\n │              Development tools  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                               │\n │              Filesystem and flash utilities  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                  │\n │              Fonts, cursors, icons, sounds and themes  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                        │\n │              Games  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                           │\n │              Graphic libraries and applications "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("graphic/text"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                               │\n │              Hardware handling  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                               │\n │              Interpreter languages and scripting  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                             │\n │              Libraries  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       │\n │              Mail  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                            │\n │              Miscellaneous  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                   │\n │              Networking applications  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                         │\n │              Package managers  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                │\n │              Real-Time  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       │\n │              Security  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                        │\n │              Shell and utilities  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                             │\n │              System tools  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                    │\n │              Text editors and viewers  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                        │\n │                                                                                                    │\n └F1Help─F2SymInfo─F3Help "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("─F4ShowAll─F5Back─F6Save─F7Load─F8SymSearch─F9Exit─────────────────────────┘\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br")])]),t("h4",{attrs:{id:"_5-按下箭头直至-hello-world-new-再摁-y-将其选为打包目标之一"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-按下箭头直至-hello-world-new-再摁-y-将其选为打包目标之一"}},[s._v("#")]),s._v(" 5. 按下箭头直至 "),t("code",[s._v("hello world (New)")]),s._v("，再摁 "),t("code",[s._v("y")]),s._v(" 将其选为打包目标之一")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("\n                 /buildroot/_packed/buildroot/.config - Buildroot "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021.02")]),s._v(" Configuration\n ┌── Target packages ─────────────────────────────────────────────────────────────────────────────────┐\n │                                                                                                    │\n │          -*- BusyBox                                                                               │\n │              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("package/busybox/busybox.config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" BusyBox configuration "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" to use? "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEW"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             │\n │              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    Additional BusyBox configuration fragment files "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEW"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                           │\n │          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   Show packages that are also provided by busybox "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEW"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                               │\n │          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   Individual binaries "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEW"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                           │\n │          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   Install the watchdog daemon startup script "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEW"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                    │\n │          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" hello world                                                                           │\n │              Audio and video applications  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                    │\n │              Compressors and decompressors  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                   │\n │              Debugging, profiling and benchmark  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                              │\n │              Development tools  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                               │\n │              Filesystem and flash utilities  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                  │\n │              Fonts, cursors, icons, sounds and themes  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                        │\n │              Games  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                           │\n │              Graphic libraries and applications "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("graphic/text"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                               │\n │              Hardware handling  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                               │\n │              Interpreter languages and scripting  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                             │\n │              Libraries  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       │\n │              Mail  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                            │\n │              Miscellaneous  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                   │\n │              Networking applications  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                         │\n │              Package managers  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                │\n │              Real-Time  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       │\n │              Security  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                        │\n │              Shell and utilities  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                             │\n │              System tools  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                    │\n │              Text editors and viewers  ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                        │\n │                                                                                                    │\n └F1Help─F2SymInfo─F3Help "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("─F4ShowAll─F5Back─F6Save─F7Load─F8SymSearch─F9Exit─────────────────────────┘\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br")])]),t("h4",{attrs:{id:"_6-连按-esc-两次-弹出询问是否保存配置对话框如下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-连按-esc-两次-弹出询问是否保存配置对话框如下"}},[s._v("#")]),s._v(" 6. 连按 "),t("code",[s._v("esc")]),s._v(" 两次，弹出询问是否保存配置对话框如下")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v(" │                                                                                                    │\n │                          ┌─────────────────────────────────────────────┐                           │\n │                          │ Do you wish to save your new configuration? │                           │\n │                          │ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("ESC"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" to cancel and resume nconfig.         │                           │\n │                          │                                             │                           │\n │                          │            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("save"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("don't save"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           │                           │\n │                          └─────────────────────────────────────────────┘                           │\n │                                                                                                    │\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h4",{attrs:{id:"_7-上述对话框默认选中-save-所以回车即可保存配置并退出"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-上述对话框默认选中-save-所以回车即可保存配置并退出"}},[s._v("#")]),s._v(" 7. 上述对话框默认选中 "),t("code",[s._v("save")]),s._v("，所以回车即可保存配置并退出")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v(" │                                                                                                    │\n │                 ┌───────────────────────────────────────────────────────────────┐                  │\n │                 │ configuration written to /buildroot/_packed/buildroot/.config │                  │\n │                 │                                                               │                  │\n │                 │                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("OK"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                              │                  │\n │                 └───────────────────────────────────────────────────────────────┘                  │\n │                                                                                                    │\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h4",{attrs:{id:"_8-此时当前目录下生成的-config-文件指示编译-hello-项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-此时当前目录下生成的-config-文件指示编译-hello-项目"}},[s._v("#")]),s._v(" 8. 此时当前目录下生成的 "),t("code",[s._v(".config")]),s._v(" 文件指示编译 hello 项目")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@0c6ea3e52ccf:/buildroot/_packed/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat .config | grep HELLO")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BR2_PACKAGE_HELLO")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("y\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"_8-更新部分软件源加速编译-可选"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-更新部分软件源加速编译-可选"}},[s._v("#")]),s._v(" 8. 更新部分软件源加速编译（可选）")]),s._v(" "),t("p",[s._v("因为默认的软件源（原始配置参见 /buildroot/buildroot/Config.in）大部分对国内不友好，我们可以将其替换为国内源以实现提速。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@0c6ea3e52ccf:/buildroot/_packed/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ustc=http://mirrors.ustc.edu.cn")]),s._v("\n\nroot@0c6ea3e52ccf:/buildroot/_packed/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# sed -i "s|BR2_KERNEL_MIRROR=.*|BR2_KERNEL_MIRROR=\\"$ustc/kernel.org\\"|g" .config')]),s._v("\nroot@0c6ea3e52ccf:/buildroot/_packed/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# sed -i "s|BR2_GNU_MIRROR=.*|BR2_GNU_MIRROR=\\"$ustc/gnu\\"|g" .config')]),s._v("\nroot@0c6ea3e52ccf:/buildroot/_packed/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# sed -i "s|BR2_CPAN_MIRROR=.*|BR2_CPAN_MIRROR=\\"$ustc/CPAN\\"|g" .config')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("blockquote",[t("p",[s._v("其中 "),t("code",[s._v("savannah.gnu.org")]),s._v(" 的源也挺难搞。")])]),s._v(" "),t("h3",{attrs:{id:"_9-编译包含-hello-项目的系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-编译包含-hello-项目的系统"}},[s._v("#")]),s._v(" 9. 编译包含 hello 项目的系统")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@0c6ea3e52ccf:/buildroot/_packed/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make hello -j")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("以上命令实际上是只是编译 hello 以及 hello 依赖的 package。当然，toolchain 会被所有 package 依赖，所以 buildroot 会先编译 toolchain。")]),s._v(" "),t("p",[s._v("编译完成后，"),t("code",[s._v("/buildroot/_packed/buildroot/output/build")]),s._v(" 目录生成的 "),t("code",[s._v("hello-0.1")]),s._v(" 文件夹即 hello 编译产物路径，"),t("code",[s._v("/buildroot/_packed/buildroot/output/target/usr/bin/")]),s._v(" 目录可看到编译产出的 hello 文件，并且确实是 ARM 交叉工具链编译出来的。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@0c6ea3e52ccf:~/optee/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls /buildroot/_packed/buildroot/output/build")]),s._v("\nbuild-time.log        host-gcc-initial-9.3.0  host-skeleton          toolchain\nbuildroot-config      host-gmp-6.2.1          linux-headers-5.10.19  toolchain-buildroot\nhello-0.1             host-m4-1.4.18          skeleton               uclibc-1.0.37\nhost-binutils-2.35.2  host-mpc-1.1.0          skeleton-init-common\nhost-gcc-final-9.3.0  host-mpfr-4.0.2         skeleton-init-sysv\nroot@0c6ea3e52ccf:~/optee/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls /buildroot/_packed/buildroot/output/target/usr/bin ")]),s._v("\ngetconf  hello  ldd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h2",{attrs:{id:"编译基于现有项目的最小系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编译基于现有项目的最小系统"}},[s._v("#")]),s._v(" 编译基于现有项目的最小系统")]),s._v(" "),t("p",[s._v("buildroot 一次 "),t("code",[s._v("make all")]),s._v(" 会把整个系统编译出来，相当耗时。如果只想要一个可以启动起来的最小系统，不需要什么其它包的话，它有什么快捷方式可以办到吗？不知道怎么办，那就得上教小白的 "),t("code",[s._v("help")]),s._v(" 命令了。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@0c6ea3e52ccf:/buildroot/_packed/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make help")]),s._v("\nCleaning:\n  clean                  - delete all files created by build\n  distclean              - delete all non-source files "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("including .config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nBuild:\n  all                    - "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" world\n  toolchain              - build toolchain\n  sdk                    - build relocatable SDK\n\nConfiguration:\n  menuconfig             - interactive curses-based configurator\n  nconfig                - interactive ncurses-based configurator\n  xconfig                - interactive Qt-based configurator\n  gconfig                - interactive GTK-based configurator\n  oldconfig              - resolve any unresolved symbols "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" .config\n  syncconfig             - Same as oldconfig, but quietly, additionally update deps\n  olddefconfig           - Same as syncconfig but sets new symbols to their default value\n  randconfig             - New config with random answer to all options\n  defconfig              - New config with default answer to all options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                             BR2_DEFCONFIG, "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" on the "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line, is used as input\n  savedefconfig          - Save current config to BR2_DEFCONFIG "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimal config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  update-defconfig       - Same as savedefconfig\n  allyesconfig           - New config where all options are accepted with "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n  allnoconfig            - New config where all options are answered with no\n  alldefconfig           - New config where all options are "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" to default\n  randpackageconfig      - New config with random answer to package options\n  allyespackageconfig    - New config where pkg options are accepted with "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n  allnopackageconfig     - New config where package options are answered with no\n\nPackage-specific:\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pkg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                  - Build and "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pkg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" and all its dependencies\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pkg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("-source           - Only download the "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" files "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pkg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br")])]),t("p",[s._v("其中 "),t("code",[s._v("allnopackageconfig")]),s._v(" 可以帮到我们："),t("code",[s._v("make xxx_defconfig")]),s._v(" 后执行 "),t("code",[s._v("make allnopackageconfig")]),s._v("，再 "),t("code",[s._v("make all")]),s._v(" 就可以只编译 toolchain，boot，kernel，busybox，rootfs 这个几个能构成系统启动的最小系统模块。")]),s._v(" "),t("p",[t("code",[s._v("make aarch64_efi_defconfig")]),s._v(" 时，由于 "),t("code",[s._v("aarch64_efi")]),s._v(" 的工具链是 toolchain-buildroot，即 buildroot 从零开始制作工具链，而不是 toolchain-external--buildroot 使用已经制作好的工具链。这样的话，如果工具链没有预先准备，则 "),t("code",[s._v("make allnopackageconfig")]),s._v("+"),t("code",[s._v("make all")]),s._v(" 之后编译过程会报错。因为制作零制作工具链需要编译某些包作为原材料，而这些包被 "),t("code",[s._v("make allnopackageconfig")]),s._v(" 屏蔽掉了。")]),s._v(" "),t("p",[s._v("已经制作好工具链或者采用 toolchain-external 模式的情况下，"),t("code",[s._v("make allnopackageconfig")]),s._v(" 编译最小系统是没用问题的。")]),s._v(" "),t("h2",{attrs:{id:"实用技巧与指令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实用技巧与指令"}},[s._v("#")]),s._v(" 实用技巧与指令")]),s._v(" "),t("p",[s._v("buildroot 的相关 make 选项如下")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"right"}},[s._v("命令")]),s._v(" "),t("th",{staticStyle:{"text-align":"left"}},[s._v("说明")])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"right"}},[t("code",[s._v("help")])]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("之前演示过了，打印出帮助菜单")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"right"}},[t("code",[s._v("show-targets")])]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("显示出本次配置所要编译所有的目标。这些目标可以单独作为模块，用 "),t("code",[s._v("make <pkg-target>")]),s._v(" 命令进行单独编译。从这条命令的显示结果来看，"),t("code",[s._v("aarch64_efi_defconfig")]),s._v(" 需要编译 busybox、uclibc（微型 C 库）等目标，当然 hello 也是一个编译目标，是在 "),t("code",[s._v("make nconfig")]),s._v(" 时候加进去的，所以可以用 "),t("code",[s._v("make hello")]),s._v(" 来编译。")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"right"}},[s._v("<pkg-target>")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("单独编译某个 pkg 模块以及其依赖的模块，比如 "),t("code",[s._v("make hello")])])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"right"}},[t("code",[s._v("pkg-rebuild")])]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("重新编译 pkg")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"right"}},[t("code",[s._v("pkg-extract")])]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("只下载解压 pkg 但不编译，pkg 解压后放在 output/build/ 目录对应的 pkg-dir 目录下")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"right"}},[t("code",[s._v("pkg-source")])]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("只下载某 pkg，然后不做任何事情")])])])]),s._v(" "),t("p",[s._v("对于本文 buildroot 的 "),t("code",[s._v("make show-targets")]),s._v(" 的输出如下")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@182f8619ce91:/buildroot/_packed/buildroot"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make show-targets")]),s._v("\nbusybox eudev grub2 hello host-acl host-attr host-autoconf host-automake host-dosfstools host-e2fsprogs host-eudev host-fakeroot host-genimage host-kmod host-libtool host-libzlib host-m4 host-makedevs host-mkpasswd host-mtools host-patchelf host-pkgconf host-skeleton host-util-linux host-zlib ifupdown-scripts initscripts kmod linux linux-headers skeleton skeleton-init-common skeleton-init-sysv toolchain toolchain-buildroot uclibc urandom-scripts util-linux util-linux-libs rootfs-ext2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("其它更多快捷指令可从 package/pkg-generic.mk 查询。这些快捷指令实际是是由 pkg- 指令这种命名框架合成的，更详细的内容请参考 "),t("a",{attrs:{href:"https://buildroot.org/downloads/manual/manual.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("手册"),t("OutboundLink")],1),s._v(" 和 package/pkg-generic.mk。")]),s._v(" "),t("h2",{attrs:{id:"参考文献"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文献"}},[s._v("#")]),s._v(" 参考文献")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://blog.csdn.net/prike/article/details/79352704",target:"_blank",rel:"noopener noreferrer"}},[s._v("buildroot 构建指南"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://buildroot.org/downloads/manual/manual.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("The Buildroot user manual"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);